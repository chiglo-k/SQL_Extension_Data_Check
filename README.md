# Missing Data Check PostgreSQL Extension

Этот проект представляет практическое решение для обработки и контроля заполненности данных. Он помогает пользователю обнаруживать и исправлять пропуски (NULL-значения) в датасетах, которые могут возникать из-за отсутствия данных, ошибок при вводе или последующих изменений информации.

## Основная идея

При работе с большими объёмами данных, постоянно поступающей информации и большим числом пользователей могут возникать ситуации, когда некоторые данные остаются незаполненными. Это особенно критично, если требуется анализировать данные за длительные периоды (месяцы и более). Представленный проект помогает:

- **Обнаруживать** пропуски в данных;
- **Сохранять** результаты проверки пропусков, включая имя файла, название колонки, таблицы и количество отсутствующих значений;
- **Анализировать** качество данных с удобным доступом к результатам.

## Структура проекта

Проект состоит из следующих файлов и компонентов:

- **analyze-data.sql**  
  Пример скрипта для применения расширения `missing_data_check`.

- **init.sql**  
  Скрипт для инициализации тестовых данных и применения расширения. Здесь создаются необходимые таблицы и загружаются тестовые данные.

- **missing_data_check.control**  
  Файл конфигурации расширения PostgreSQL. Он содержит метаданные о расширении.

- **missing_data_check--1.0.sql**  
  Основной SQL-скрипт, содержащий логику расширения для анализа пропусков. В нём реализована функция на Python для проверки данных.

- **Dockerfile**  
  Инструкция для развертывания контейнера с PostgreSQL и Python, который содержит тестовые данные и все необходимые настройки для работы расширения.

## Основные функции расширения

Расширение предоставляет следующие функции для работы с качеством данных:

- **data_quality.save_missing_data_results(table_name TEXT, exclude_columns TEXT[] DEFAULT NULL)**  
  - Проверяет указанную таблицу на наличие `NULL` значений.
  - Сохраняет информацию о пропущенных данных в таблицу `data_quality.missing_data_results`.
  - Возвращает количество записей с пропущенными данными.

- **data_quality.get_current_datetime()**  
  - Возвращает текущую дату и время.

Результаты проверок сохраняются в таблице `data_quality.missing_data_results`, где каждая запись содержит:
- Название файла,
- Название колонки,
- Название таблицы,
- Количество пропусков.

Данные в таблицу добавляются только при явном вызове функции `data_quality.save_missing_data_results()`.

## Запуск через Docker

Для удобства развертывания и тестирования проекта используется Docker. После создания Docker образа, сервер PostgreSQL запускается с тестовыми данными и расширением.

### Инструкция по сборке и запуску

1. **Сборка Docker образа:**

   ```bash
   docker build -t postgres-with-missing-data-check .
   ```
2. **Запуск Docker образа:**

   ```bash
   docker run -d --name postgres-missing-data -e POSTGRES_PASSWORD=sql123 -p 5433:5432 postgres-with-missing-data-check
   ```



3. **Подключение к PostgreSQL:**

После запуска контейнера подключение осуществляется по следующим параметрам:

    ```
    Хост: localhost
    Порт: 5433
    Пользователь: postgres
    Пароль: sql123
    ```

## Примеры использования

**Проверка таблицы на наличие NULL значений: **

```sql
SELECT data_quality.save_missing_data_results('your_table_name', ARRAY['exclude_column1', 'exclude_column2']);
```

**Запуск этой функции:**

Проанализирует таблицу your_table_name на наличие NULL значений (за исключением колонок, указанных во втором параметре).
Сохранит результаты проверки в таблице data_quality.missing_data_results.
Вернёт количество найденных записей с пропусками.


## Заключение

Это расширение помогает обеспечить высокое качество данных, позволяя своевременно обнаруживать и фиксировать пропуски. Такое решение является особенно полезным при работе с большими объёмами информации, где пропуски могут негативно сказаться на итоговом анализе.
